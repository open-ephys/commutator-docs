
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Details of Remote Controls &#8212; Open Ephys Documentation 0.0.0 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" href="../../../_static/theme_overrides.css" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="How to Control Commutation with Bonsai and Key Presses" href="bonsai-keypress-control.html" />
    <link rel="prev" title="Remote Commutator Control" href="index.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../../index.html">
  <img src="../../../_static/oe_logo_name.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../index.html">
  Open Ephys Commutators
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../coax-commutator/index.html">
  Coax Commutator
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../../index.html">
  SPI Commutator
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://open-ephys.org">Open Ephys<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/open-ephys/commutator-docs" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/openephys" rel="noopener" target="_blank" title="Twitter"><span><i class="fab fa-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://discord.gg/WXAx2URNQU" rel="noopener" target="_blank" title="Discord"><span><i class="fab fa-discord"></i></span>
            <label class="sr-only">Discord</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../index.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../quick-start-guide/index.html">
   Quick Start Guide
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../index.html">
   User Guide
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../mount-connect.html">
     Mounting and Connecting the Commutator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../status-led.html">
     Commutator Status and LED Feedback
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../manual-control.html">
     Manual Commutator Control
    </a>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="index.html">
     Remote Commutator Control
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       Details of Remote Controls
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="bonsai-keypress-control.html">
       How to Control Commutation with Bonsai and Key Presses
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="bonsai-headstage64-automate.html">
       How to Automate Commutation with Bonsai and Headstage-64
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="bonsai-miniscope-automate.html">
       How to Automate Commutation with Bonsai and Miniscope
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="gui-miniscope-automate.html">
       How to Automate Commutation with GUI and Ephys Headstage
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshooting.html">
     Troubleshooting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../developer-guide/index.html">
   Developer Guide
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../developer-guide/mechanical.html">
     Mechanical
    </a>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#teensy">
   Teensy
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#communication-protocol-json">
   Communication Protocol (JSON)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#json-commands">
     JSON Commands
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#enable">
       enable
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#led">
       led
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#speed">
       speed
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#turn">
       turn
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#print">
       print
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#compound-json-command">
       Compound JSON Command
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#communication-protocol-examples">
   Communication Protocol Examples
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bonsai-integration">
   Bonsai Integration
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="details-of-remote-controls">
<h1>Details of Remote Controls<a class="headerlink" href="#details-of-remote-controls" title="Permalink to this headline">#</a></h1>
<section id="teensy">
<h2>Teensy<a class="headerlink" href="#teensy" title="Permalink to this headline">#</a></h2>
<p>The Teensy is a microcontroller development board (much like the Arduino for those who are familiar). It is the brains
of the commutator. To control the commutator via computer, it helps to learn to interface with the Teensy. To do that:</p>
<ol class="arabic simple">
<li><p>Download the <a class="reference external" href="https://www.arduino.cc/en/software">Arduino IDE</a></p></li>
<li><p>Install the Arduino IDE’s Teensy plugin, <a class="reference external" href="https://www.pjrc.com/teensy/td_download.html">Teensyduino</a></p></li>
<li><p>Install relevant <a class="reference external" href="https://docs.arduino.cc/software/ide-v2/tutorials/ide-v2-installing-a-library">Arduino libraries</a>: <em>AccelStepper</em> and <em>Arduino JSON</em></p></li>
<li><p>Open the <a class="reference external" href="https://docs.arduino.cc/software/ide-v2/tutorials/ide-v2-serial-monitor">Arduino IDE’s serial monitor</a></p></li>
<li><p>Set correct COM port to which the Teensy is connected and set the serial monitor baud rate to 9600</p></li>
<li><p>Send a command to the commutator according to the communication below.</p></li>
</ol>
<p>The serial monitor displays messages between the commutator and the computer to which the commutator is connected. Other serial
monitors can be used (see <a class="reference external" href="https://www.compuphase.com/software_termite.htm">Termite</a> for instance), but these
instructions recommend the Arduino IDE because the Arduino IDE is already quite common and allows the user to program
the Teensy in a convenient way if that is desired. Out-of-the-box, the commutator’s Teensy is pre-programmed to receive
messages from the user through serial communication. To communicate with the commutator using the serial monitor, refer
to the following communication protocol.</p>
</section>
<section id="communication-protocol-json">
<h2>Communication Protocol (JSON)<a class="headerlink" href="#communication-protocol-json" title="Permalink to this headline">#</a></h2>
<p>The commutator communicates with a computer through the serial monitor using JavaScript Object Notation (JSON). For the
purpose of interfacing with the commutator, JSON is a human-readable notation used to specify a property and assign a value to
or read the value of that corresponding property. The notation is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nb">property</span><span class="p">:</span> <span class="n">value</span><span class="p">}</span>
</pre></div>
</div>
<p>The commutator has five properties/commands:
<em>enable</em>, <em>led</em>, <em>speed</em>, <em>turn</em>, and <em>read</em>. The set of acceptable values depends on the property to which the value is being
assigned. This is how to use JSON to communicate with the commutator:</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>The commutator only accepts JSON commands while buttons are not pressed</p>
</div>
<section id="json-commands">
<h3>JSON Commands<a class="headerlink" href="#json-commands" title="Permalink to this headline">#</a></h3>
<section id="enable">
<h4>enable<a class="headerlink" href="#enable" title="Permalink to this headline">#</a></h4>
<p>Acceptable values: <em>false</em>, <em>true</em></p>
<ul class="simple">
<li><p>A <em>true</em> value for this property enables the commutator</p></li>
<li><p>A <em>false</em> value for this property disables the commutator</p></li>
</ul>
<p>The default out-of-the-box value for this property is <em>false</em></p>
</section>
<section id="led">
<h4>led<a class="headerlink" href="#led" title="Permalink to this headline">#</a></h4>
<p>Acceptable values: <em>false</em>, <em>true</em></p>
<ul class="simple">
<li><p>A <em>true</em> value for this property enables the LED function</p></li>
<li><p>A <em>false</em> value for this property disables the LED function</p></li>
</ul>
<p>The default out-of-the-box value for this property is <em>true</em></p>
</section>
<section id="speed">
<h4>speed<a class="headerlink" href="#speed" title="Permalink to this headline">#</a></h4>
<p>Acceptable values: (<em>0</em>, <em>500</em>]</p>
<ul class="simple">
<li><p>The value for this property sets the rotational speed of the commutator in units of RPM</p></li>
</ul>
<p>The default out-of-the-box value for this property is <em>50</em></p>
</section>
<section id="turn">
<h4>turn<a class="headerlink" href="#turn" title="Permalink to this headline">#</a></h4>
<p>Acceptable values: [<em>-255?</em>, <em>255?</em>]</p>
<ul class="simple">
<li><p>The value for this property sets the rotational speed of the commutator in units of RPM</p></li>
</ul>
<p>There is no default out-of-the-box value for this property</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>what is the set of acceptable values?</p>
</div>
</section>
<section id="print">
<h4>print<a class="headerlink" href="#print" title="Permalink to this headline">#</a></h4>
<p>Acceptable values: n/a</p>
<ul class="simple">
<li><p>Leave the value field empty. The commutator prints out the internal state of the commutator to the user in the serial interface</p></li>
</ul>
<p>There is no default out-of-the-box value for this property</p>
</section>
<section id="compound-json-command">
<h4>Compound JSON Command<a class="headerlink" href="#compound-json-command" title="Permalink to this headline">#</a></h4>
<p>Multiple commands can be sent in a compound JSON message in the following format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">property1</span><span class="p">:</span> <span class="n">value1</span><span class="p">,</span> <span class="n">property2</span><span class="p">:</span> <span class="n">value2</span><span class="p">,</span> <span class="n">property3</span><span class="p">:</span> <span class="n">value3</span><span class="p">}</span>
</pre></div>
</div>
<p>The order of properties does not matter.</p>
</section>
</section>
</section>
<section id="communication-protocol-examples">
<h2>Communication Protocol Examples<a class="headerlink" href="#communication-protocol-examples" title="Permalink to this headline">#</a></h2>
<p>Enable the commutator:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">enable</span><span class="p">:</span> <span class="n">true</span><span class="p">}</span>
</pre></div>
</div>
<p>Disable the commutator’s LED function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">led</span><span class="p">:</span> <span class="n">false</span><span class="p">}</span>
</pre></div>
</div>
<p>Set the commutator’s rotational speed to 250 RPM:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">speed</span><span class="p">:</span> <span class="mi">250</span><span class="p">}</span>
</pre></div>
</div>
<p>Turn the commutator’s 1.1 revolutions CW:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">turn</span><span class="p">:</span> <span class="mf">1.1</span><span class="p">}</span>
</pre></div>
</div>
<p>Turn the commutator’s 2.3 revolutions CCW:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">turn</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.3</span><span class="p">}</span>
</pre></div>
</div>
<p>Disable LED feedback function, set speed to 25 RPM, and turn the commutator 1.1 revolutions clockwise all in one message:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">led</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span> <span class="n">speed</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="n">turn</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.1</span><span class="p">}</span>
</pre></div>
</div>
<p>Query the status of the commutator’s internal parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nb">print</span><span class="p">:}</span>
</pre></div>
</div>
</section>
<section id="bonsai-integration">
<h2>Bonsai Integration<a class="headerlink" href="#bonsai-integration" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://open-ephys.org/bonsai">Bonsai</a> is open-source software for processing asynchronous, heterogeneous streams of
data. In our case, it can be used to coordinate orientation data (from an IMU sensor or camera sensor for instance) to
provide feedback to commutator and automate the commutation process. To learn more about how to use Bonsai, explore the
<a class="reference external" href="https://bonsai-rx.org/">bonsai-rx.org</a> website. It’s quite nice software so it is recommended. It is used in many of the
following guides for controlling and automating the commutator.</p>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="index.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Remote Commutator Control</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="bonsai-keypress-control.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">How to Control Commutation with Bonsai and Key Presses</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2010-2023, Open Ephys &amp; Contributors.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>
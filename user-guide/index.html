
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>User Guide &#8212; Commie-tator Documentation 0.0.0 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Developer Guide" href="../developer-guide/index.html" />
    <link rel="prev" title="Quick Start" href="../quick-start-guide/index.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/oe_logo_template.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../quick-start-guide/index.html">
  Quick Start
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="current reference internal nav-link" href="#">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../developer-guide/index.html">
  Developer Guide
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://open-ephys.org">Open Ephys<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/open-ephys/onix-docs" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/openephys" rel="noopener" target="_blank" title="Twitter"><span><i class="fab fa-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://discord.gg/WXAx2URNQU" rel="noopener" target="_blank" title="Discord"><span><i class="fab fa-discord"></i></span>
            <label class="sr-only">Discord</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#whats-included">
   What’s Included?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#oec-overview">
   OEC Overview
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#manual-control">
     Manual Control
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stop-go-should-be-changed-to-enable-disable-to-be-more-intuitive-those-buttons-don-t-do-what-i-thought-they-did-by-their-label">
     Stop/go should be changed to enable/disable to be more intuitive; those buttons don’t do what I thought they did by their label
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#computer-control">
     Computer Control
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#teensy">
       Teensy
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#communication-protocol">
       Communication Protocol
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#examples">
         Examples
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bonsai-integration">
       Bonsai Integration
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#troubleshooting">
   Troubleshooting
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#warranty-return-policy">
   Warranty/Return Policy
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                

<div class="tocsection editthispage">
    <a href="https://github.com/open-ephys/commutator-docs/edit/main/source/user-guide/index.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="user-guide">
<span id="ref-faq"></span><h1>User Guide<a class="headerlink" href="#user-guide" title="Permalink to this headline">#</a></h1>
<p>This user guide</p>
<dl class="glossary simple">
</dl>
<section id="whats-included">
<h2>What’s Included?<a class="headerlink" href="#whats-included" title="Permalink to this headline">#</a></h2>
<ol class="arabic simple">
<li><p>Commutator</p></li>
<li><p>SMA to Hirose X.FL Headstage Tether</p></li>
</ol>
</section>
<section id="oec-overview">
<h2>OEC Overview<a class="headerlink" href="#oec-overview" title="Permalink to this headline">#</a></h2>
<p>Features include:</p>
<ul class="simple">
<li><p>Lightweight tether for minimal disturbance to the animal</p></li>
<li><p>High bandwidth (18 GHz) tether for signal fidelity in the frequencies of interest</p></li>
<li><p>Manual commutator control using integrated capacitive buttons</p></li>
<li><p>Computer control using human-readable JSON commands</p></li>
<li><p>Optical table &amp; 80/20 rail mountable</p></li>
<li><p>RGB LED status indicator (can be turned off)</p></li>
<li><p>Silent and precise motor driver</p></li>
<li><p>Modular - Compatible with computer vision systems or IMU systems (not sure if this a feature)</p></li>
<li><p>USB Powered</p></li>
</ul>
<p>OEC functions and benefits</p>
<p>OEC Parameters</p>
<p>Saving settings
Control and speed parameters, whether changed via the remote or manual interface, are saved in non-volatile memory
each time they are changed. The device will start in the same state it was last used even after losing power</p>
<p>LED Feedback</p>
<p>One major difference between manual control and computer control is manual control toggles a jog while computer control
sets the OEC to move by a specified amount.</p>
<p>Combined with Bonsai, the OEC can be used to automatically commutate the tether.</p>
<p>The following sections provide an overview of how the user interfaces with the OEC</p>
<section id="manual-control">
<h3>Manual Control<a class="headerlink" href="#manual-control" title="Permalink to this headline">#</a></h3>
<ul>
<li><p>Stop/Go Button: toggle OEC enable/disable manually</p>
<blockquote>
<div><p>Disabled (red LED): Motor halts instantly. Pressing directional buttons incurs no reaction. All
target turns provided via remote calls is cleared such that re-enabling the motor does not result in the OEC
re-engaging an old target position. To re-enable the OEC, hold the Stop/Go button for &gt; 0.5 second or send the
appropriate remote command</p>
<p>Enabled (green LED): The motor can be turned via button presses or RPCs. Pressing the Stop/Go button instantly disables the device</p>
</div></blockquote>
</li>
</ul>
</section>
<section id="stop-go-should-be-changed-to-enable-disable-to-be-more-intuitive-those-buttons-don-t-do-what-i-thought-they-did-by-their-label">
<h3>Stop/go should be changed to enable/disable to be more intuitive; those buttons don’t do what I thought they did by their label<a class="headerlink" href="#stop-go-should-be-changed-to-enable-disable-to-be-more-intuitive-those-buttons-don-t-do-what-i-thought-they-did-by-their-label" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><dl class="simple">
<dt>Direction Button (2x): Manually control the motor rotation in the direction indicated on each button when the OEC is</dt><dd><p>Enabled. These inputs take precedence over and override ongoing remote motor control. When pressed, all target turnsprovided via remote control will be cleared, such that releasing them will not result in the OEC re-engaging an
old target position. Remote commands sent when a button is being pressed are ignored</p>
</dd>
</dl>
</li>
<li><p>LED Button: pressing the LED toggles the LED function (for cases in which the LED presents unwanted visual stimulus)</p></li>
</ul>
</section>
<section id="computer-control">
<h3>Computer Control<a class="headerlink" href="#computer-control" title="Permalink to this headline">#</a></h3>
<p>The following sections describe how to interact with the OEC using a computer.</p>
<section id="teensy">
<h4>Teensy<a class="headerlink" href="#teensy" title="Permalink to this headline">#</a></h4>
<p>The Teensy is a microcontroller development board (much like the Arduino for those who are familiar). It is the brains
of the OEC. To control the OEC via computer, the user must learn to interface with the Teensy. To do that:</p>
<ol class="arabic simple">
<li><p>Download the <a class="reference external" href="https://www.arduino.cc/en/software">Arduino IDE</a></p></li>
<li><p>Install the Arduino IDE’s Teensy plugin, <a class="reference external" href="https://www.pjrc.com/teensy/td_download.html">Teensyduino</a></p></li>
<li><p>Open the <a class="reference external" href="https://docs.arduino.cc/software/ide-v2/tutorials/ide-v2-serial-monitor">Arduino IDE’s serial monitor</a></p></li>
<li><p>Set the serial monitor baud rate to 115200?</p></li>
</ol>
<p>The serial monitor  displays messages to and from the OEC and the computer to which the OEC is connected. Other serial
monitors can be used (see <a class="reference external" href="https://www.compuphase.com/software_termite.htm">Termite</a> for instance), but these
instructions recommend the Arduino IDE because the Arduino IDE is already quite common and allows the user to conveniently
program the Teensy. To communicate with the OEC using the serial monitor, refer to the following communication protocol.</p>
</section>
<section id="communication-protocol">
<h4>Communication Protocol<a class="headerlink" href="#communication-protocol" title="Permalink to this headline">#</a></h4>
<p>The OEC communicates with a computer through the serial monitor using JavaScript Object Notation (JSON). For the
purpose of interfacing with the OEC, JSON is a human-readable notation used to specify a property of the OEC and assign
a value to that corresponding property. The notation is: {property, value}. The OEC has five properties: enable, led,
speed, turn, and read. The set of acceptable values depends on the property to which the value is being assigned.
This is how to use JSON to communicate with the OEC:</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>The OEC only accepts JSON commands only while buttons are not pressed</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>was something else going to go here?</p>
</div>
<p><strong>enable</strong></p>
<p>Acceptable values: [<em>false</em>, <em>true</em>]</p>
<blockquote>
<div><ul class="simple">
<li><p>A <em>true</em> value for this property enables the OEC</p></li>
<li><p>A <em>false</em> value for this property disables the OEC</p></li>
</ul>
</div></blockquote>
<p>The default out-of-the-box value for this property is <em>false</em></p>
<p><strong>led</strong></p>
<p>Acceptable values: [<em>false</em>, <em>true</em>]</p>
<blockquote>
<div><ul class="simple">
<li><p>A <em>true</em> value for this property enables the LED function</p></li>
<li><p>A <em>false</em> value for this property disables the LED function</p></li>
</ul>
</div></blockquote>
<p>The default out-of-the-box value for this property is <em>true</em></p>
<p><strong>speed</strong></p>
<p>Acceptable values: (<em>0</em>, <em>500</em>]</p>
<blockquote>
<div><ul class="simple">
<li><p>The value for this property sets the rotational speed of the OEC in units of RPM</p></li>
</ul>
</div></blockquote>
<p>The default out-of-the-box value for this property is <em>50</em></p>
<p><strong>turn</strong></p>
<p>Acceptable values: [<em>-255?</em>, <em>255?</em>]</p>
<blockquote>
<div><ul class="simple">
<li><p>The value for this property sets the rotational speed of the OEC in units of RPM</p></li>
</ul>
</div></blockquote>
<p>There is no default out-of-the-box value for this property</p>
<p><strong>print</strong></p>
<p>Acceptable values: n/a</p>
<blockquote>
<div><ul class="simple">
<li><p>Leave the value field empty. The OEC prints out the internal state of the OEC to the user in the serial interface</p></li>
</ul>
</div></blockquote>
<p>There is no default out-of-the-box value for this property</p>
<p>Multiple commands can be sent in one JSON message in the following format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">property1</span><span class="p">,</span> <span class="n">value1</span><span class="p">,</span> <span class="n">property2</span><span class="p">,</span> <span class="n">value2</span><span class="p">,</span> <span class="n">property3</span><span class="p">,</span> <span class="n">value3</span><span class="p">}</span>
</pre></div>
</div>
<p>The order of properties does not matter in this case.</p>
<section id="examples">
<h5>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">#</a></h5>
<p>Enable the OEC:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">enable</span> <span class="p">:</span> <span class="n">true</span><span class="p">}</span>
</pre></div>
</div>
<p>Disable the OEC’s LED function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">led</span> <span class="p">:</span> <span class="n">false</span><span class="p">}</span>
</pre></div>
</div>
<p>Set the OEC’s rotational speed to 250 RPM:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">speed</span> <span class="p">:</span> <span class="mi">250</span><span class="p">}</span>
</pre></div>
</div>
<p>Turn the OEC’s 1.1 revolutions CW:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">turn</span> <span class="p">:</span> <span class="mf">1.1</span><span class="p">}</span>
</pre></div>
</div>
<p>Turn the OEC’s 2.3 revolutions CCW:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">turn</span> <span class="p">:</span> <span class="o">-</span><span class="mf">2.3</span><span class="p">}</span>
</pre></div>
</div>
<p>Disable LED function, set speed to 25 RPM, and turn the OEC 1.1 revolutions clockwise all in one message:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">led</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span> <span class="n">speed</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="n">turn</span> <span class="p">:</span> <span class="o">-</span><span class="mf">1.1</span><span class="p">}</span>
</pre></div>
</div>
<p>The status of the OEC can be read using the {print:} command which will return a JSON object containing
parameters.</p>
</section>
</section>
<section id="bonsai-integration">
<h4>Bonsai Integration<a class="headerlink" href="#bonsai-integration" title="Permalink to this headline">#</a></h4>
<p><a class="reference external" href="https://open-ephys.org/bonsai">Bonsai</a> is open-source software for processing heterogeneous streams of data. It can
be used to coordinate orientation data (IMU or visual) to provide feedback to OEC and automate the commutation process.</p>
<ol class="arabic">
<li><p>Download and install Bonsai</p></li>
<li><p>Install packages required for your experiment:</p>
<blockquote>
<div><ul class="simple">
<li><p>Bonsai.StarterPack</p></li>
<li><p>Bonsai.ONIX.Design (required only if using Onix)</p></li>
<li><p>Bonsai.Miniscope (required only if using miniscope)</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Download example workflow (see below)</p></li>
<li><p>Open and run example workflow (see below)</p></li>
<li><p>Active compensation using Bonsai</p></li>
</ol>
<p>We have included example workflows for remote active compensation under each use case:
Usage with Miniscope DAQ
Remote control using Bonsai
<a class="reference external" href="https://open-ephys.github.io/onix-docs/Software%20Guide/Bonsai%20Examples/Commutator.html">https://open-ephys.github.io/onix-docs/Software%20Guide/Bonsai%20Examples/Commutator.html</a></p>
<p>To learn more about how to use Bonsai, explore the <a class="reference external" href="https://bonsai-rx.org/">bonsai-rx.org</a> website</p>
</section>
</section>
</section>
<section id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">#</a></h2>
</section>
<section id="warranty-return-policy">
<h2>Warranty/Return Policy<a class="headerlink" href="#warranty-return-policy" title="Permalink to this headline">#</a></h2>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../quick-start-guide/index.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Quick Start</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../developer-guide/index.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Developer Guide</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2010-2023, Open Ephys &amp; Contributors.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>